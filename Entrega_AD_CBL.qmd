---
title: "Entrega_AD"
author: "Carlos Bayés"
format: html
editor: visual
Rendering:
    embed-resources: true
---
```{r}
library(MASS)
library(tidyverse)
```

# Primer paso
Queremos estudiar como afecta a la salud mental de los universitarios las redes sociales de manera simulada. Para ello a cada individuo le mediremos la cantidad de horas al día que pasa en las RRSS., su edad, la red social más usada y la sensación de estar perdiendo el tiempo entre otras.

# Segundo paso
Creamos las medias por individuo y la matriz de covarianzas de las variables cuantitativas de la simulación:

```{r}
media <- c(5,20,350,10) #Media de horas_redes_día, edad, cantidad_seguidores, cantidad_publicaciones
covarianza <- matrix(c(4, 2, 10, 1,
                       2, 6, 3, 1,
                       10, 3, 50, 5,
                       1, 1, 5, 1.5), 
                     nrow = 4, ncol = 4)
```

Ahora creamos la distribución tal y como pide el enunciado:
```{r}
set.seed(42)
datos_numericos <- mvrnorm(150, mu = media, Sigma = covarianza)
```

Con esto, construimos la primera tabla de datos:
```{r}
datos_RRSS_1 <- data.frame(
  horas_redes_dia = round(datos_numericos[,1]),
  edad = round(datos_numericos[,2]),
  cantidad_seguidores = round(datos_numericos[,3]),
  cantidad_publicaciones = round(datos_numericos[,4]),
  sexo = sample(c("Hombre", "Mujer"), 150, replace = TRUE),
  red_mas_usada = sample(c("Instagram", "X", "You Tube", "Otra"), 150, replace = TRUE),
  frecuencia_publicacion = ordered(sample(1:5, 150, replace = TRUE), labels = c("Nunca", "Anual", "Mensula", "Semanal", "Diario")),
  limitacion_activa = ordered(sample(1:5, 150, replace = TRUE), labels = c("Nada", "Poco", "Regular", "Frecuente", "Muy Frecuente")),
  frecuencia_afectacion_diaria = ordered(sample(1:5, 150, replace = TRUE), labels = c("Nada", "Poco", "Regular", "Frecuente", "Muy Frecuente"))
)
head(datos_RRSS_1)
```

Ahora creamos la segunda tabla. Al no encontrar datos en internet que se ajusten adecuadamente a la simulación que se propone, se hará uso de una encuesta realizada en la UIB el curso pasado a modo de proyecto para la asignatura de "Estadística", que trataba temas similares y en la que está inspirada esta misma práctica. La encuesta fue realizada por un equipo al cual el autor pertenecía, con lo cual no se están usando dichos datos de manera ilícita. Dicho esto. tomaremos las variables de las preguntas sobre los sentimientos FOMO y sobre si los perfiles en RRSS de los individuos son públicos o privados. Creémosla:
```{r}
datos_tabla2 <- read.csv("C:/Users/34663/Desktop/Entrega_AD_CBL/Copia de El Rol de las Redes Sociales en la Salud Mental (respuestas) - Respuestas de formulario 1.csv")
datos_RRSS_2 <- datos_tabla2[1:150, c("X.Has.experimentado.alguna.vez.sentimientos.de.FOMO..miedo.a.perderse.algo..al.ver.las.publicaciones.de.otras.personas.en.redes.sociales.", "En.la.red.social.que.más.seguidores.tengas...tu.perfil.es.público.o.privado.")]
colnames(datos_RRSS_2) <- c("experimentacion_FOMO", "privacidad_perfil")
head(datos_RRSS_2)
```
A partir de estas dos tablas creadas, crearemos la tabla a partir de la cual realizaremos el estudio estadístico:
```{r}
datos_RRSS <- cbind(datos_RRSS_1,datos_RRSS_2)
head(datos_RRSS)
```

# Tercer paso

## Primera correlación
Lo primero que queremos estudiar es la relación entre la expirementación de FOMO con las horas gastadas en RRSS por cada inidividuo. Para ello, al ser las respuestas a la pregunta sobre el FOMO "Sí" o "No", podemos codificarlas con valores numéricos, es decir, a cada "Sí" le asociamos un $1$ y a cada "No" le asociamos un $0$:
```{r}
datos_RRSS <- datos_RRSS %>%
  mutate(FOMO_numerico = case_when(
    experimentacion_FOMO == "Sí" ~ 1,
    experimentacion_FOMO == "No" ~ 0,
  ))
```

En este caso, al tener una variable cuantitativa (las horas en RRSS), y una binaria, (la experimentación del FOMO), un test de correlación se ajusta a nuestras necesidades:
```{r}
cor.test(datos_RRSS$horas_redes_dia, datos_RRSS$FOMO_numerico)
```

## Segunda correlación
Podemos ver que la correlación es bastante crecana a $0$, por tanto, no hay correlación aparente entre la cantidad de horas gastadas en las redes sociales y la experimentación de FOMO.\\
Ahora nos interesa ver si hay relación entre las horas en RRSS con cuanto creen los individuos observados que las RRSS afectan su vida. Para ello graficaremos los resultados:
```{r}
ggplot(datos_RRSS, aes(x = limitacion_activa, y = horas_redes_dia)) +
  geom_boxplot(fill = "skyblue", color = "darkblue") +
  labs(x = "Frecuencia de Afectación Diaria", y = "Horas en Redes Sociales", 
       title = "Distribución de Horas en Redes Sociales según Frecuencia de Afectación Diaria") +
  theme_minimal()
```
Vemos que aparentemente en esta simulación, las horas están distribuidas homogéneamente entre las distintas categorías, dando a entender que tampoco podemos asegurar una correlación en este caso. De igual manera realizaremos un test ANOVA tomando un nivel de significancia del $0.05$ para ver si esto es cierto.
```{r}
anova1 = aov(horas_redes_dia ~ frecuencia_afectacion_diaria, data = datos_RRSS)
summary(anova1)
```
Como vemos, el p-valor es $0.604$, que es bastante más que nuestro nivel de significancia. De aquí se puede deducir, como ya mostraba el boxplot, que no hay relación entre la cantidad de horas gastadas en RRSS y como le afectan las RRSS a cada individuo en su vida diaria.

